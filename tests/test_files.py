from library import files


def test_file_encoding_convert():
    path_file_in = './data/dist200015an-verificato.xml'
    path_file_out = './data/test_file_out.xml'

    assert files.file_encoding_convert(path_file_in, path_file_out,
                                       'windows-1252', 'utf-8') is True

def test_filestxt_to_list():
    path_file_in = './data/consuma_test.sql'
    # path_file_out = './data/consuma.test.sql'

    expected_list = [
        "",
        "INSERT INTO [Erdis_Read].[dbo].[in4_consumazioni]([DATA_REG_EBADGE] ,[DATA_REG_CASSA] ,[PRESIDIO] ,[IDANA] ,[UTENTE_ID] ,[COGNOME] ,[NOME] ,[IDCON] ,[CONSUMAZIONE_ID] ,[STATUS] ,[TESSERA_ID] ,[IDENTIFICAZIONE_ID] ,[TIPO_PAGAMENTO_ID] ,[OPERATORE_USER] ,[TURNO_ID] ,[RISTORANTE_PRESIDIO] ,[RISTORANTE] ,[CASSA] ,[ACQUISTO] ,[TIPO_LISTINO_ID] ,[PREZZO_TOTALE] ,[COSTO_TOTALE] ,[VALORE_PASTO] ,[OFFLINE] ,[PRENOTAZIONE] ,[BRUCIATURA_DATA] ,[BRUCIATURA_CASSA_ID] ,[BRUCIATURA_CASSA] ,[PRA_ANNO_ACCADEMICO] ,[PRA_PROFILO_ID] ,[PRA_PROFILO] ,[PRA_CATEGORIA_ID] ,[PRA_CATEGORIA] ,[PRA_RICAVO_MENSA] ,[PRA_MODALITA_ID] ,[PRA_MODALITA] ,[PRA_TIPO_LISTINO_ID] ,[PRA_TIPO_LISTINO]) VALUES ('DATA_REG_EBADGE', 'DATA_REG_CASSA', 'PRESIDIO', 'IDANA', 'UTENTE_ID', 'COGNOME', 'NOME', 'IDCON', 'CONSUMAZIONE_ID', 'STATUS', 'TESSERA_ID', 'IDENTIFICAZIONE_ID', 'TIPO_PAGAMENTO_ID', 'OPERATORE_USER', 'TURNO_ID', 'RISTORANTE_PRESIDIO', 'RISTORANTE', 'CASSA', 'ACQUISTO', 'TIPO_LISTINO_ID', 'PREZZO_TOTALE', 'COSTO_TOTALE', 'VALORE_PASTO', 'OFFLINE', 'PRENOTAZIONE', 'BRUCIATURA_DATA', 'BRUCIATURA_CASSA_ID', 'BRUCIATURA_CASSA', 'PRA_ANNO_ACCADEMICO', 'PRA_PROFILO_ID', 'PRA_PROFILO', 'PRA_CATEGORIA_ID', 'PRA_CATEGORIA', 'PRA_RICAVO_MENSA', 'PRA_MODALITA_ID', 'PRA_MODALITA', 'PRA_TIPO_LISTINO_ID', 'PRA_TIPO_LISTINO');",
        "INSERT INTO [Erdis_Read].[dbo].[in4_consumazioni]([DATA_REG_EBADGE] ,[DATA_REG_CASSA] ,[PRESIDIO] ,[IDANA] ,[UTENTE_ID] ,[COGNOME] ,[NOME] ,[IDCON] ,[CONSUMAZIONE_ID] ,[STATUS] ,[TESSERA_ID] ,[IDENTIFICAZIONE_ID] ,[TIPO_PAGAMENTO_ID] ,[OPERATORE_USER] ,[TURNO_ID] ,[RISTORANTE_PRESIDIO] ,[RISTORANTE] ,[CASSA] ,[ACQUISTO] ,[TIPO_LISTINO_ID] ,[PREZZO_TOTALE] ,[COSTO_TOTALE] ,[VALORE_PASTO] ,[OFFLINE] ,[PRENOTAZIONE] ,[BRUCIATURA_DATA] ,[BRUCIATURA_CASSA_ID] ,[BRUCIATURA_CASSA] ,[PRA_ANNO_ACCADEMICO] ,[PRA_PROFILO_ID] ,[PRA_PROFILO] ,[PRA_CATEGORIA_ID] ,[PRA_CATEGORIA] ,[PRA_RICAVO_MENSA] ,[PRA_MODALITA_ID] ,[PRA_MODALITA] ,[PRA_TIPO_LISTINO_ID] ,[PRA_TIPO_LISTINO]) VALUES ('2024-01-31 21:19:38', '2024-01-31 21:19:37', 'URBINO', '2000103657', '1000011496', 'MANNISI', 'REBECCA', '1000433503', 'd7439156-65f6-4a7f-9ea3-84ddfab8f7de', 'A', '1003772', 'AUTO', 'BOR', 'OPERATORE_1017', 'TUR02', 'URBINO', 'Mensa Tridente', 'Cassa 01', 'Pasto Completo', 'L00', '0.0', '7.51', '5.50', 'N', '', '', '', '', '2023', 'PTT', 'Tutti i ristoranti', 'F0-09', 'BORSISTI/IDONEI AS GRATUITI', 'R530.001.001', 'GG', 'Primo pasto Gratuito Secondo pasto Gratuito', 'L00', 'Listino 0');",
        "INSERT INTO [Erdis_Read].[dbo].[in4_consumazioni]([DATA_REG_EBADGE] ,[DATA_REG_CASSA] ,[PRESIDIO] ,[IDANA] ,[UTENTE_ID] ,[COGNOME] ,[NOME] ,[IDCON] ,[CONSUMAZIONE_ID] ,[STATUS] ,[TESSERA_ID] ,[IDENTIFICAZIONE_ID] ,[TIPO_PAGAMENTO_ID] ,[OPERATORE_USER] ,[TURNO_ID] ,[RISTORANTE_PRESIDIO] ,[RISTORANTE] ,[CASSA] ,[ACQUISTO] ,[TIPO_LISTINO_ID] ,[PREZZO_TOTALE] ,[COSTO_TOTALE] ,[VALORE_PASTO] ,[OFFLINE] ,[PRENOTAZIONE] ,[BRUCIATURA_DATA] ,[BRUCIATURA_CASSA_ID] ,[BRUCIATURA_CASSA] ,[PRA_ANNO_ACCADEMICO] ,[PRA_PROFILO_ID] ,[PRA_PROFILO] ,[PRA_CATEGORIA_ID] ,[PRA_CATEGORIA] ,[PRA_RICAVO_MENSA] ,[PRA_MODALITA_ID] ,[PRA_MODALITA] ,[PRA_TIPO_LISTINO_ID] ,[PRA_TIPO_LISTINO]) VALUES ('2024-01-31 21:13:15', '2024-01-31 21:13:15', 'CAMERINO', '2000129959', '1000106006', 'BRAVETTI', 'LEONARDO', '1000433502', '0845244e-ca69-41ca-a4ee-dae21b9995b1', 'A', '1009955', 'AUTO', 'BOR', 'OPERATORE_1010', 'TUR02', 'CAMERINO', 'Mensa La Rinascita', 'Cassa 01', 'Pasto Completo', 'L00', '0.0', '10.0', '5.50', 'N', '', '', '', '', '2023', 'PTT', 'Tutti i ristoranti', 'F0-09', 'BORSISTI/IDONEI AS GRATUITI', 'R530.001.001', 'GG', 'Primo pasto Gratuito Secondo pasto Gratuito', 'L00', 'Listino 0');"
    ]

    assert expected_list[2:] == files.filetxt_to_list(path_file_in)[2:]